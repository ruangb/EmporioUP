@model IEnumerable<EmporioUP.Models.Cliente>

@{
    ViewBag.Title = "Clientes";
}
<h1 class="text-center">Clientes</h1>
<hr />
<div class="text-center">
    <button class="btn btn-info btn-sm" data-toggle="modal" data-target="#atualiza_cliente"
            style="background-color:mediumpurple; color:white; border-color:mediumpurple" ;>
        Novo cliente&nbsp;
        <span class="glyphicon glyphicon-plus"></span>
    </button>
</div>
<hr />
<!-- Modal -->
<div class="modal fade" id="atualiza_cliente" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <button type="button" class="close"
                        data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Cadastrar cliente
                </h4>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <form class="form-horizontal" role="form" method="post" action="/Cliente/Cliente_Atualiza">
                    <input type="hidden" class="form-control" name="id_cliente" id="id_cliente" value="0" />
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="nome">Nome do cliente</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="nome" id="nome" placeholder="Digite o nome do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="cpf">CPF do cliente</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="cpf" id="cpf" placeholder="Digite o CPF do cliente" maxlength="14" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="cep">CEP</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="cep" id="cep" placeholder="Digite o CEP do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="uf">UF</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="uf" id="uf" placeholder="Digite a UF do cliente" maxlength="2" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="cidade">Cidade</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="cidade" id="cidade" placeholder="Digite a cidade do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="bairro">Bairro</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="bairro" id="bairro" placeholder="Digite o bairro do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="logradouro">Logradouro</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="logradouro" id="endereco" placeholder="Digite o logradouro do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="numero">Número</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="numero" id="numero" placeholder="Digite o número de endereço do cliente" required />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"
                               for="complemento">Complemento</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="complemento" id="complemento" placeholder="Digite o complemento do endereço do cliente" />
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" class="btn btn-success">Salvar</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn"
                        data-dismiss="modal" style="background-color:dimgray; color:white;">
                    Fechar
                </button>
            </div>
        </div>
    </div>
</div>
<!--modal-->

<div id="list" class="row">
    <table class="table table-bordered table-hover" cellspacing="0" cellpadding="0" id="myTable">
        <thead>
            <tr>
                <th>Código do cliente</th>
                <th>Nome</th>
                <th>Data de adesão</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.id_cliente)</td>
                    <td> @Html.DisplayFor(modelItem => item.nome)</td>
                    <td>@Html.DisplayFor(modelItem => item.dataAdesao)</td>
                    <td class="text-center">
                        <button type="submit" class="btn btn-success" style="color:white;">
                            @Html.ActionLink("Editar", "ClientesEditar", new { id = item.id_cliente }, new { @style = "color:#ffffff;" })
                        </button>
                        <button type="submit" class="btn btn-info" style="color:white;">
                            @Html.ActionLink("Detalhes", "ClientesDetalhes", new { id = item.id_cliente }, new { @style = "color:#ffffff;" })
                        </button>
                        <button type="submit" class="btn btn-danger" style="color:white;">
                            @Html.ActionLink("Deletar", "ClientesDeletar", new { id = item.id_cliente }, new { @style = "color:#ffffff;" })
                        </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@section scripts{
    <link rel="stylesheet" href="https://getbootstrap.com/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/css/jquery.dataTables.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#myTable').DataTable({
                "language": {
                    "lengthMenu": "Mostrando _MENU_ registros por página",
                    "zeroRecords": "Nenhum Registro Encontrado",
                    "info": "Mostrando Página _PAGE_ de _PAGES_",
                    "infoEmpty": "Nenhum registro Disponível",
                    "infoFiltered": "(filtrado de _MAX_ registro no total)"
                }
            });
        });
    </script>
    <script src="http://code.jquery.com/jquery-3.0.0.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.maskedinput/1.4.1/jquery.maskedinput.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
           $("#date").mask("99/99/9999");
            $("#cpf").mask("999.999.999-99");
            $("#cep").mask("99999-999", {
                completed: function () {
                    var cep = $(this).val().replace(/[^0-9]/, "");

                    // Validação do CEP; caso o CEP não possua 8 números, então cancela
                    // a consulta
                    if (cep.length != 8) {
                        return false;
                    }

                    // A url de pesquisa consiste no endereço do webservice + o cep que
                    // o usuário informou + o tipo de retorno desejado (entre "json",
                    // "jsonp", "xml", "piped" ou "querty")
                    var url = "http://viacep.com.br/ws/" + cep + "/json/";

                    $.getJSON(url, function (dadosRetorno) {
                        try {
                            // Preenche os campos de acordo com o retorno da pesquisa
                            $("#endereco").val(dadosRetorno.logradouro);
                            $("#bairro").val(dadosRetorno.bairro);
                            $("#cidade").val(dadosRetorno.localidade);
                            $("#uf").val(dadosRetorno.uf);
                            $("#nr_end").focus();
                        } catch (ex) { }
                    });
                }
            });

        });
    </script>
}